{
  "document": {
    "aggregate_severity": {
      "namespace": "https://www.suse.com/support/security/rating/",
      "text": "important"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright 2023 SUSE LLC. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "summary",
        "text": "SUSE CVE-2022-24812",
        "title": "Title"
      },
      {
        "category": "description",
        "text": "Grafana is an open-source platform for monitoring and observability. When fine-grained access control is enabled and a client uses Grafana API Key to make requests, the permissions for that API Key are cached for 30 seconds for the given organization. Because of the way the cache ID is constructed, the consequent requests with any API Key evaluate to the same permissions as the previous requests. This can lead to an escalation of privileges, when for example a first request is made with Admin permissions, and the second request with different API Key is made with Viewer permissions, the second request will get the cached permissions from the previous Admin, essentially accessing higher privilege than it should. The vulnerability is only impacting Grafana Enterprise when the fine-grained access control beta feature is enabled and there are more than one API Keys in one organization with different roles assigned. All installations after Grafana Enterprise v8.1.0-beta1 should be upgraded as soon as possible. As an alternative, disable fine-grained access control will mitigate the vulnerability.",
        "title": "Description of the CVE"
      },
      {
        "category": "legal_disclaimer",
        "text": "CSAF 2.0 data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
        "title": "Terms of use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://www.suse.com/support/security/contact/",
      "name": "SUSE Product Security Team",
      "namespace": "https://www.suse.com/"
    },
    "references": [
      {
        "category": "external",
        "summary": "CVE-2022-24812",
        "url": "https://www.suse.com/security/cve/CVE-2022-24812"
      },
      {
        "category": "external",
        "summary": "SUSE Security Ratings",
        "url": "https://www.suse.com/support/security/rating/"
      },
      {
        "category": "external",
        "summary": "SUSE Bug 1198454 for CVE-2022-24812",
        "url": "https://bugzilla.suse.com/1198454"
      }
    ],
    "title": "SUSE CVE CVE-2022-24812",
    "tracking": {
      "current_release_date": "2023-02-15T03:27:35Z",
      "generator": {
        "date": "2023-02-15T03:27:35Z",
        "engine": {
          "name": "cve-database.git:bin/generate-csaf-vex.pl",
          "version": "1"
        }
      },
      "id": "CVE-2022-24812",
      "initial_release_date": "2023-02-15T03:27:35Z",
      "revision_history": [
        {
          "date": "2023-02-15T03:27:35Z",
          "number": "2",
          "summary": "Current version"
        }
      ],
      "status": "interim",
      "version": "2"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "HPE Helion OpenStack 8",
                "product": {
                  "name": "HPE Helion OpenStack 8",
                  "product_id": "HPE Helion OpenStack 8",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:suse:hpe-helion-openstack:8"
                  }
                }
              },
              {
                "category": "product_name",
                "name": "SUSE Enterprise Storage 6",
                "product": {
                  "name": "SUSE Enterprise Storage 6",
                  "product_id": "SUSE Enterprise Storage 6",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:suse:ses:6"
                  }
                }
              },
              {
                "category": "product_name",
                "name": "SUSE Manager Client Tools Beta for SLE 12",
                "product": {
                  "name": "SUSE Manager Client Tools Beta for SLE 12",
                  "product_id": "SUSE Manager Client Tools Beta for SLE 12",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:suse:sle-manager-tools-beta:12"
                  }
                }
              },
              {
                "category": "product_name",
                "name": "SUSE Manager Client Tools Beta for SLE 15",
                "product": {
                  "name": "SUSE Manager Client Tools Beta for SLE 15",
                  "product_id": "SUSE Manager Client Tools Beta for SLE 15",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:suse:sle-manager-tools-beta:15"
                  }
                }
              },
              {
                "category": "product_name",
                "name": "SUSE Manager Client Tools for SLE 12",
                "product": {
                  "name": "SUSE Manager Client Tools for SLE 12",
                  "product_id": "SUSE Manager Client Tools for SLE 12",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:suse:sle-manager-tools:12"
                  }
                }
              },
              {
                "category": "product_name",
                "name": "SUSE Manager Client Tools for SLE 15",
                "product": {
                  "name": "SUSE Manager Client Tools for SLE 15",
                  "product_id": "SUSE Manager Client Tools for SLE 15",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:suse:sle-manager-tools:15"
                  }
                }
              },
              {
                "category": "product_name",
                "name": "SUSE OpenStack Cloud 8",
                "product": {
                  "name": "SUSE OpenStack Cloud 8",
                  "product_id": "SUSE OpenStack Cloud 8",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:suse:suse-openstack-cloud:8"
                  }
                }
              },
              {
                "category": "product_name",
                "name": "SUSE OpenStack Cloud 9",
                "product": {
                  "name": "SUSE OpenStack Cloud 9",
                  "product_id": "SUSE OpenStack Cloud 9",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:suse:suse-openstack-cloud:9"
                  }
                }
              },
              {
                "category": "product_name",
                "name": "SUSE OpenStack Cloud Crowbar 8",
                "product": {
                  "name": "SUSE OpenStack Cloud Crowbar 8",
                  "product_id": "SUSE OpenStack Cloud Crowbar 8",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:suse:suse-openstack-cloud-crowbar:8"
                  }
                }
              },
              {
                "category": "product_name",
                "name": "SUSE OpenStack Cloud Crowbar 9",
                "product": {
                  "name": "SUSE OpenStack Cloud Crowbar 9",
                  "product_id": "SUSE OpenStack Cloud Crowbar 9",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:suse:suse-openstack-cloud-crowbar:9"
                  }
                }
              },
              {
                "category": "product_name",
                "name": "openSUSE Tumbleweed",
                "product": {
                  "name": "openSUSE Tumbleweed",
                  "product_id": "openSUSE Tumbleweed",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:opensuse:tumbleweed"
                  }
                }
              },
              {
                "category": "product_version",
                "name": "grafana",
                "product": {
                  "name": "grafana",
                  "product_id": "grafana",
                  "product_identification_helper": {
                    "cpe": "cpe:2.3:a:grafana:grafana:*:*:*:*:*:*:*:*"
                  }
                }
              },
              {
                "category": "product_version",
                "name": "grafana-8.5.10-1.1",
                "product": {
                  "name": "grafana-8.5.10-1.1",
                  "product_id": "grafana-8.5.10-1.1",
                  "product_identification_helper": {
                    "cpe": "cpe:2.3:a:grafana:grafana:8.5.10:*:*:*:*:*:*:*"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "SUSE Linux Enterprise"
          }
        ],
        "category": "vendor",
        "name": "SUSE"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "grafana-8.5.10-1.1 as component of openSUSE Tumbleweed",
          "product_id": "openSUSE Tumbleweed:grafana-8.5.10-1.1"
        },
        "product_reference": "grafana-8.5.10-1.1",
        "relates_to_product_reference": "openSUSE Tumbleweed"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "grafana as component of HPE Helion OpenStack 8",
          "product_id": "HPE Helion OpenStack 8:grafana"
        },
        "product_reference": "grafana",
        "relates_to_product_reference": "HPE Helion OpenStack 8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "grafana as component of SUSE Enterprise Storage 6",
          "product_id": "SUSE Enterprise Storage 6:grafana"
        },
        "product_reference": "grafana",
        "relates_to_product_reference": "SUSE Enterprise Storage 6"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "grafana as component of SUSE Manager Client Tools Beta for SLE 12",
          "product_id": "SUSE Manager Client Tools Beta for SLE 12:grafana"
        },
        "product_reference": "grafana",
        "relates_to_product_reference": "SUSE Manager Client Tools Beta for SLE 12"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "grafana as component of SUSE Manager Client Tools Beta for SLE 15",
          "product_id": "SUSE Manager Client Tools Beta for SLE 15:grafana"
        },
        "product_reference": "grafana",
        "relates_to_product_reference": "SUSE Manager Client Tools Beta for SLE 15"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "grafana as component of SUSE Manager Client Tools for SLE 12",
          "product_id": "SUSE Manager Client Tools for SLE 12:grafana"
        },
        "product_reference": "grafana",
        "relates_to_product_reference": "SUSE Manager Client Tools for SLE 12"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "grafana as component of SUSE Manager Client Tools for SLE 15",
          "product_id": "SUSE Manager Client Tools for SLE 15:grafana"
        },
        "product_reference": "grafana",
        "relates_to_product_reference": "SUSE Manager Client Tools for SLE 15"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "grafana as component of SUSE OpenStack Cloud 8",
          "product_id": "SUSE OpenStack Cloud 8:grafana"
        },
        "product_reference": "grafana",
        "relates_to_product_reference": "SUSE OpenStack Cloud 8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "grafana as component of SUSE OpenStack Cloud 9",
          "product_id": "SUSE OpenStack Cloud 9:grafana"
        },
        "product_reference": "grafana",
        "relates_to_product_reference": "SUSE OpenStack Cloud 9"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "grafana as component of SUSE OpenStack Cloud Crowbar 8",
          "product_id": "SUSE OpenStack Cloud Crowbar 8:grafana"
        },
        "product_reference": "grafana",
        "relates_to_product_reference": "SUSE OpenStack Cloud Crowbar 8"
      },
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "grafana as component of SUSE OpenStack Cloud Crowbar 9",
          "product_id": "SUSE OpenStack Cloud Crowbar 9:grafana"
        },
        "product_reference": "grafana",
        "relates_to_product_reference": "SUSE OpenStack Cloud Crowbar 9"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2022-24812",
      "ids": [
        {
          "system_name": "SUSE CVE Page",
          "text": "https://www.suse.com/security/cve/CVE-2022-24812"
        }
      ],
      "notes": [
        {
          "category": "general",
          "text": "Grafana is an open-source platform for monitoring and observability. When fine-grained access control is enabled and a client uses Grafana API Key to make requests, the permissions for that API Key are cached for 30 seconds for the given organization. Because of the way the cache ID is constructed, the consequent requests with any API Key evaluate to the same permissions as the previous requests. This can lead to an escalation of privileges, when for example a first request is made with Admin permissions, and the second request with different API Key is made with Viewer permissions, the second request will get the cached permissions from the previous Admin, essentially accessing higher privilege than it should. The vulnerability is only impacting Grafana Enterprise when the fine-grained access control beta feature is enabled and there are more than one API Keys in one organization with different roles assigned. All installations after Grafana Enterprise v8.1.0-beta1 should be upgraded as soon as possible. As an alternative, disable fine-grained access control will mitigate the vulnerability.",
          "title": "Vulnerability description"
        }
      ],
      "product_status": {
        "fixed": [
          "openSUSE Tumbleweed:grafana-8.5.10-1.1"
        ],
        "known not affected": [
          "HPE Helion OpenStack 8:grafana",
          "SUSE Enterprise Storage 6:grafana",
          "SUSE Manager Client Tools Beta for SLE 12:grafana",
          "SUSE Manager Client Tools Beta for SLE 15:grafana",
          "SUSE Manager Client Tools for SLE 12:grafana",
          "SUSE Manager Client Tools for SLE 15:grafana",
          "SUSE OpenStack Cloud 8:grafana",
          "SUSE OpenStack Cloud 9:grafana",
          "SUSE OpenStack Cloud Crowbar 8:grafana",
          "SUSE OpenStack Cloud Crowbar 9:grafana"
        ]
      },
      "references": [
        {
          "category": "external",
          "summary": "CVE-2022-24812",
          "url": "https://www.suse.com/security/cve/CVE-2022-24812"
        },
        {
          "category": "external",
          "summary": "SUSE Security Ratings",
          "url": "https://www.suse.com/support/security/rating/"
        },
        {
          "category": "external",
          "summary": "SUSE Bug 1198454 for CVE-2022-24812",
          "url": "https://bugzilla.suse.com/1198454"
        }
      ],
      "remediations": [
        {
          "category": "vendor_fix",
          "details": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
          "product_ids": [
            "openSUSE Tumbleweed:grafana-8.5.10-1.1"
          ]
        }
      ],
      "scores": [
        {
          "cvss_v3": {
            "baseScore": 8.8,
            "baseSeverity": "HIGH",
            "vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:H/I:H/A:H",
            "version": "3.1"
          },
          "products": [
            "openSUSE Tumbleweed:grafana-8.5.10-1.1"
          ]
        }
      ],
      "threats": [
        {
          "category": "impact",
          "date": "2022-04-12T14:00:12Z",
          "details": "important"
        }
      ],
      "title": "CVE-2022-24812"
    }
  ]
}
