{
	"document": {
		"aggregate_severity": {
			"namespace": "https://www.suse.com/support/security/rating/",
			"text": "moderate"
		},
		"category": "csaf_vex",
		"csaf_version": "2.0",
		"distribution": {
			"text": "Copyright 2024 SUSE LLC. All rights reserved.",
			"tlp": {
				"label": "WHITE",
				"url": "https://www.first.org/tlp/"
			}
		},
		"lang": "en",
		"notes": [
			{
				"category": "summary",
				"text": "SUSE CVE-2023-0290",
				"title": "Title"
			},
			{
				"category": "description",
				"text": "Rapid7 Velociraptor did not properly sanitize the client ID parameter to the CreateCollection API, allowing a directory traversal in where the collection task could be written. It was possible to provide a client id of \"../clients/server\" to schedule the collection for the server (as a server artifact), but only require privileges to schedule collections on the client. Normally, to schedule an artifact on the server, the COLLECT_SERVER permission is required. This permission is normally only granted to \"administrator\" role. Due to this issue, it is sufficient to have the COLLECT_CLIENT privilege, which is normally granted to the \"investigator\" role. To exploit this vulnerability, the attacker must already have a Velociraptor user account at least \"investigator\" level, and be able to authenticate to the GUI and issue an API call to the backend. Typically, most users deploy Velociraptor with limited access to a trusted group, and most users will already be administrators within the GUI. This issue affects Velociraptor versions before 0.6.7-5. Version 0.6.7-5, released January 16, 2023, fixes the issue.",
				"title": "Description of the CVE"
			},
			{
				"category": "legal_disclaimer",
				"text": "CSAF 2.0 data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
				"title": "Terms of use"
			}
		],
		"publisher": {
			"category": "vendor",
			"contact_details": "https://www.suse.com/support/security/contact/",
			"name": "SUSE Product Security Team",
			"namespace": "https://www.suse.com/"
		},
		"references": [
			{
				"category": "external",
				"summary": "CVE-2023-0290",
				"url": "https://www.suse.com/security/cve/CVE-2023-0290"
			},
			{
				"category": "external",
				"summary": "SUSE Security Ratings",
				"url": "https://www.suse.com/support/security/rating/"
			},
			{
				"category": "external",
				"summary": "SUSE Bug 1207937 for CVE-2023-0290",
				"url": "https://bugzilla.suse.com/1207937"
			}
		],
		"title": "SUSE CVE CVE-2023-0290",
		"tracking": {
			"current_release_date": "2024-07-26T03:48:20Z",
			"generator": {
				"date": "2023-02-15T03:21:57Z",
				"engine": {
					"name": "cve-database.git:bin/generate-csaf-vex.pl",
					"version": "1"
				}
			},
			"id": "CVE-2023-0290",
			"initial_release_date": "2023-02-15T03:21:57Z",
			"revision_history": [
				{
					"date": "2023-02-15T03:21:57Z",
					"number": "2",
					"summary": "Current version"
				},
				{
					"date": "2023-05-10T01:57:16Z",
					"number": "3",
					"summary": "Current version"
				},
				{
					"date": "2024-06-07T02:47:23Z",
					"number": "4",
					"summary": "Current version"
				},
				{
					"date": "2024-06-08T03:28:23Z",
					"number": "5",
					"summary": "Current version"
				},
				{
					"date": "2024-07-26T03:48:20Z",
					"number": "6",
					"summary": "Current version"
				}
			],
			"status": "interim",
			"version": "6"
		}
	},
	"product_tree": {
		"branches": [
			{
				"branches": [
					{
						"branches": [
							{
								"category": "product_name",
								"name": "SUSE Linux Enterprise Micro 6.0",
								"product": {
									"name": "SUSE Linux Enterprise Micro 6.0",
									"product_id": "SUSE Linux Enterprise Micro 6.0",
									"product_identification_helper": {
										"cpe": "cpe:/o:suse:sl-micro:6.0"
									}
								}
							},
							{
								"category": "product_name",
								"name": "openSUSE Tumbleweed",
								"product": {
									"name": "openSUSE Tumbleweed",
									"product_id": "openSUSE Tumbleweed",
									"product_identification_helper": {
										"cpe": "cpe:/o:opensuse:tumbleweed"
									}
								}
							},
							{
								"category": "product_version",
								"name": "system-user-velociraptor-1.0.0-1.17",
								"product": {
									"name": "system-user-velociraptor-1.0.0-1.17",
									"product_id": "system-user-velociraptor-1.0.0-1.17"
								}
							},
							{
								"category": "product_version",
								"name": "system-user-velociraptor-1.0.0-2.1",
								"product": {
									"name": "system-user-velociraptor-1.0.0-2.1",
									"product_id": "system-user-velociraptor-1.0.0-2.1"
								}
							},
							{
								"category": "product_version",
								"name": "velociraptor-0.6.7.5~git78.2bef6fc-2.1",
								"product": {
									"name": "velociraptor-0.6.7.5~git78.2bef6fc-2.1",
									"product_id": "velociraptor-0.6.7.5~git78.2bef6fc-2.1",
									"product_identification_helper": {
										"cpe": "cpe:2.3:a:rapid7:velociraptor:0.6.7.5~git78.2bef6fc:*:*:*:*:*:*:*"
									}
								}
							},
							{
								"category": "product_version",
								"name": "velociraptor-client-0.6.7.5~git81.01be570-1.17",
								"product": {
									"name": "velociraptor-client-0.6.7.5~git81.01be570-1.17",
									"product_id": "velociraptor-client-0.6.7.5~git81.01be570-1.17"
								}
							},
							{
								"category": "product_version",
								"name": "velociraptor-kafka-humio-gateway-0.6.7.5~git78.2bef6fc-2.1",
								"product": {
									"name": "velociraptor-kafka-humio-gateway-0.6.7.5~git78.2bef6fc-2.1",
									"product_id": "velociraptor-kafka-humio-gateway-0.6.7.5~git78.2bef6fc-2.1"
								}
							}
						],
						"category": "product_family",
						"name": "SUSE Linux Enterprise"
					}
				],
				"category": "vendor",
				"name": "SUSE"
			}
		],
		"relationships": [
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "system-user-velociraptor-1.0.0-1.17 as component of SUSE Linux Enterprise Micro 6.0",
					"product_id": "SUSE Linux Enterprise Micro 6.0:system-user-velociraptor-1.0.0-1.17"
				},
				"product_reference": "system-user-velociraptor-1.0.0-1.17",
				"relates_to_product_reference": "SUSE Linux Enterprise Micro 6.0"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "velociraptor-client-0.6.7.5~git81.01be570-1.17 as component of SUSE Linux Enterprise Micro 6.0",
					"product_id": "SUSE Linux Enterprise Micro 6.0:velociraptor-client-0.6.7.5~git81.01be570-1.17"
				},
				"product_reference": "velociraptor-client-0.6.7.5~git81.01be570-1.17",
				"relates_to_product_reference": "SUSE Linux Enterprise Micro 6.0"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "system-user-velociraptor-1.0.0-2.1 as component of openSUSE Tumbleweed",
					"product_id": "openSUSE Tumbleweed:system-user-velociraptor-1.0.0-2.1"
				},
				"product_reference": "system-user-velociraptor-1.0.0-2.1",
				"relates_to_product_reference": "openSUSE Tumbleweed"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "velociraptor-0.6.7.5~git78.2bef6fc-2.1 as component of openSUSE Tumbleweed",
					"product_id": "openSUSE Tumbleweed:velociraptor-0.6.7.5~git78.2bef6fc-2.1"
				},
				"product_reference": "velociraptor-0.6.7.5~git78.2bef6fc-2.1",
				"relates_to_product_reference": "openSUSE Tumbleweed"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "velociraptor-kafka-humio-gateway-0.6.7.5~git78.2bef6fc-2.1 as component of openSUSE Tumbleweed",
					"product_id": "openSUSE Tumbleweed:velociraptor-kafka-humio-gateway-0.6.7.5~git78.2bef6fc-2.1"
				},
				"product_reference": "velociraptor-kafka-humio-gateway-0.6.7.5~git78.2bef6fc-2.1",
				"relates_to_product_reference": "openSUSE Tumbleweed"
			}
		]
	},
	"vulnerabilities": [
		{
			"cve": "CVE-2023-0290",
			"ids": [
				{
					"system_name": "SUSE CVE Page",
					"text": "https://www.suse.com/security/cve/CVE-2023-0290"
				}
			],
			"notes": [
				{
					"category": "general",
					"text": "Rapid7 Velociraptor did not properly sanitize the client ID parameter to the CreateCollection API, allowing a directory traversal in where the collection task could be written. It was possible to provide a client id of \"../clients/server\" to schedule the collection for the server (as a server artifact), but only require privileges to schedule collections on the client. Normally, to schedule an artifact on the server, the COLLECT_SERVER permission is required. This permission is normally only granted to \"administrator\" role. Due to this issue, it is sufficient to have the COLLECT_CLIENT privilege, which is normally granted to the \"investigator\" role. To exploit this vulnerability, the attacker must already have a Velociraptor user account at least \"investigator\" level, and be able to authenticate to the GUI and issue an API call to the backend. Typically, most users deploy Velociraptor with limited access to a trusted group, and most users will already be administrators within the GUI. This issue affects Velociraptor versions before 0.6.7-5. Version 0.6.7-5, released January 16, 2023, fixes the issue.",
					"title": "CVE description"
				}
			],
			"product_status": {
				"recommended": [
					"SUSE Linux Enterprise Micro 6.0:system-user-velociraptor-1.0.0-1.17",
					"SUSE Linux Enterprise Micro 6.0:velociraptor-client-0.6.7.5~git81.01be570-1.17",
					"openSUSE Tumbleweed:system-user-velociraptor-1.0.0-2.1",
					"openSUSE Tumbleweed:velociraptor-0.6.7.5~git78.2bef6fc-2.1",
					"openSUSE Tumbleweed:velociraptor-kafka-humio-gateway-0.6.7.5~git78.2bef6fc-2.1"
				]
			},
			"references": [
				{
					"category": "external",
					"summary": "CVE-2023-0290",
					"url": "https://www.suse.com/security/cve/CVE-2023-0290"
				},
				{
					"category": "external",
					"summary": "SUSE Security Ratings",
					"url": "https://www.suse.com/support/security/rating/"
				},
				{
					"category": "external",
					"summary": "SUSE Bug 1207937 for CVE-2023-0290",
					"url": "https://bugzilla.suse.com/1207937"
				}
			],
			"remediations": [
				{
					"category": "vendor_fix",
					"details": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
					"product_ids": [
						"SUSE Linux Enterprise Micro 6.0:system-user-velociraptor-1.0.0-1.17",
						"SUSE Linux Enterprise Micro 6.0:velociraptor-client-0.6.7.5~git81.01be570-1.17",
						"openSUSE Tumbleweed:system-user-velociraptor-1.0.0-2.1",
						"openSUSE Tumbleweed:velociraptor-0.6.7.5~git78.2bef6fc-2.1",
						"openSUSE Tumbleweed:velociraptor-kafka-humio-gateway-0.6.7.5~git78.2bef6fc-2.1"
					]
				}
			],
			"scores": [
				{
					"cvss_v3": {
						"baseScore": 4.3,
						"baseSeverity": "MEDIUM",
						"vectorString": "CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N",
						"version": "3.1"
					},
					"products": [
						"SUSE Linux Enterprise Micro 6.0:system-user-velociraptor-1.0.0-1.17",
						"SUSE Linux Enterprise Micro 6.0:velociraptor-client-0.6.7.5~git81.01be570-1.17",
						"openSUSE Tumbleweed:system-user-velociraptor-1.0.0-2.1",
						"openSUSE Tumbleweed:velociraptor-0.6.7.5~git78.2bef6fc-2.1",
						"openSUSE Tumbleweed:velociraptor-kafka-humio-gateway-0.6.7.5~git78.2bef6fc-2.1"
					]
				}
			],
			"threats": [
				{
					"category": "impact",
					"date": "2023-02-06T13:24:40Z",
					"details": "moderate"
				}
			],
			"title": "CVE-2023-0290"
		}
	]
}
