{
	"document": {
		"aggregate_severity": {
			"namespace": "https://www.suse.com/support/security/rating/",
			"text": "moderate"
		},
		"category": "csaf_vex",
		"csaf_version": "2.0",
		"distribution": {
			"text": "Copyright 2023 SUSE LLC. All rights reserved.",
			"tlp": {
				"label": "WHITE",
				"url": "https://www.first.org/tlp/"
			}
		},
		"lang": "en",
		"notes": [
			{
				"category": "summary",
				"text": "SUSE CVE-2023-35934",
				"title": "Title"
			},
			{
				"category": "description",
				"text": "yt-dlp is a command-line program to download videos from video sites. During file downloads, yt-dlp or the external downloaders that yt-dlp employs may leak cookies on HTTP redirects to a different host, or leak them when the host for download fragments differs from their parent manifest's host. This vulnerable behavior is present in yt-dlp prior to 2023.07.06 and nightly 2023.07.06.185519. All native and external downloaders are affected, except for `curl` and `httpie` (version 3.1.0 or later).\n\nAt the file download stage, all cookies are passed by yt-dlp to the file downloader as a `Cookie` header, thereby losing their scope. This also occurs in yt-dlp's info JSON output, which may be used by external tools. As a result, the downloader or external tool may indiscriminately send cookies with requests to domains or paths for which the cookies are not scoped.\n\nyt-dlp version 2023.07.06 and nightly 2023.07.06.185519 fix this issue by removing the `Cookie` header upon HTTP redirects; having native downloaders calculate the `Cookie` header from the cookiejar, utilizing external downloaders' built-in support for cookies instead of passing them as header arguments, disabling HTTP redirectiong if the external downloader does not have proper cookie support, processing cookies passed as HTTP headers to limit their scope, and having a separate field for cookies in the info dict storing more information about scoping\n\nSome workarounds are available for those who are unable to upgrade. Avoid using cookies and user authentication methods. While extractors may set custom cookies, these usually do not contain sensitive information. Alternatively, avoid using `--load-info-json`. Or, if authentication is a must: verify the integrity of download links from unknown sources in browser (including redirects) before passing them to yt-dlp; use `curl` as external downloader, since it is not impacted; and/or avoid fragmented formats such as HLS/m3u8, DASH/mpd and ISM.",
				"title": "Description of the CVE"
			},
			{
				"category": "legal_disclaimer",
				"text": "CSAF 2.0 data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
				"title": "Terms of use"
			}
		],
		"publisher": {
			"category": "vendor",
			"contact_details": "https://www.suse.com/support/security/contact/",
			"name": "SUSE Product Security Team",
			"namespace": "https://www.suse.com/"
		},
		"references": [
			{
				"category": "external",
				"summary": "CVE-2023-35934",
				"url": "https://www.suse.com/security/cve/CVE-2023-35934"
			},
			{
				"category": "external",
				"summary": "SUSE Security Ratings",
				"url": "https://www.suse.com/support/security/rating/"
			},
			{
				"category": "external",
				"summary": "SUSE Bug 1213124 for CVE-2023-35934",
				"url": "https://bugzilla.suse.com/1213124"
			}
		],
		"title": "SUSE CVE CVE-2023-35934",
		"tracking": {
			"current_release_date": "2023-08-18T02:11:46Z",
			"generator": {
				"date": "2023-07-08T02:27:58Z",
				"engine": {
					"name": "cve-database.git:bin/generate-csaf-vex.pl",
					"version": "1"
				}
			},
			"id": "CVE-2023-35934",
			"initial_release_date": "2023-07-08T02:27:58Z",
			"revision_history": [
				{
					"date": "2023-07-08T02:27:58Z",
					"number": "2",
					"summary": "Current version"
				},
				{
					"date": "2023-08-18T02:11:46Z",
					"number": "3",
					"summary": "Current version"
				}
			],
			"status": "interim",
			"version": "3"
		}
	},
	"product_tree": {
		"branches": [
			{
				"branches": [
					{
						"branches": [
							{
								"category": "product_name",
								"name": "openSUSE Tumbleweed",
								"product": {
									"name": "openSUSE Tumbleweed",
									"product_id": "openSUSE Tumbleweed",
									"product_identification_helper": {
										"cpe": "cpe:/o:opensuse:tumbleweed"
									}
								}
							},
							{
								"category": "product_version",
								"name": "yt-dlp-2023.07.06-1.1",
								"product": {
									"name": "yt-dlp-2023.07.06-1.1",
									"product_id": "yt-dlp-2023.07.06-1.1"
								}
							},
							{
								"category": "product_version",
								"name": "yt-dlp-bash-completion-2023.07.06-1.1",
								"product": {
									"name": "yt-dlp-bash-completion-2023.07.06-1.1",
									"product_id": "yt-dlp-bash-completion-2023.07.06-1.1"
								}
							},
							{
								"category": "product_version",
								"name": "yt-dlp-fish-completion-2023.07.06-1.1",
								"product": {
									"name": "yt-dlp-fish-completion-2023.07.06-1.1",
									"product_id": "yt-dlp-fish-completion-2023.07.06-1.1"
								}
							},
							{
								"category": "product_version",
								"name": "yt-dlp-zsh-completion-2023.07.06-1.1",
								"product": {
									"name": "yt-dlp-zsh-completion-2023.07.06-1.1",
									"product_id": "yt-dlp-zsh-completion-2023.07.06-1.1"
								}
							}
						],
						"category": "product_family",
						"name": "SUSE Linux Enterprise"
					}
				],
				"category": "vendor",
				"name": "SUSE"
			}
		],
		"relationships": [
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "yt-dlp-2023.07.06-1.1 as component of openSUSE Tumbleweed",
					"product_id": "openSUSE Tumbleweed:yt-dlp-2023.07.06-1.1"
				},
				"product_reference": "yt-dlp-2023.07.06-1.1",
				"relates_to_product_reference": "openSUSE Tumbleweed"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "yt-dlp-bash-completion-2023.07.06-1.1 as component of openSUSE Tumbleweed",
					"product_id": "openSUSE Tumbleweed:yt-dlp-bash-completion-2023.07.06-1.1"
				},
				"product_reference": "yt-dlp-bash-completion-2023.07.06-1.1",
				"relates_to_product_reference": "openSUSE Tumbleweed"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "yt-dlp-fish-completion-2023.07.06-1.1 as component of openSUSE Tumbleweed",
					"product_id": "openSUSE Tumbleweed:yt-dlp-fish-completion-2023.07.06-1.1"
				},
				"product_reference": "yt-dlp-fish-completion-2023.07.06-1.1",
				"relates_to_product_reference": "openSUSE Tumbleweed"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "yt-dlp-zsh-completion-2023.07.06-1.1 as component of openSUSE Tumbleweed",
					"product_id": "openSUSE Tumbleweed:yt-dlp-zsh-completion-2023.07.06-1.1"
				},
				"product_reference": "yt-dlp-zsh-completion-2023.07.06-1.1",
				"relates_to_product_reference": "openSUSE Tumbleweed"
			}
		]
	},
	"vulnerabilities": [
		{
			"cve": "CVE-2023-35934",
			"ids": [
				{
					"system_name": "SUSE CVE Page",
					"text": "https://www.suse.com/security/cve/CVE-2023-35934"
				}
			],
			"notes": [
				{
					"category": "general",
					"text": "yt-dlp is a command-line program to download videos from video sites. During file downloads, yt-dlp or the external downloaders that yt-dlp employs may leak cookies on HTTP redirects to a different host, or leak them when the host for download fragments differs from their parent manifest's host. This vulnerable behavior is present in yt-dlp prior to 2023.07.06 and nightly 2023.07.06.185519. All native and external downloaders are affected, except for `curl` and `httpie` (version 3.1.0 or later).\n\nAt the file download stage, all cookies are passed by yt-dlp to the file downloader as a `Cookie` header, thereby losing their scope. This also occurs in yt-dlp's info JSON output, which may be used by external tools. As a result, the downloader or external tool may indiscriminately send cookies with requests to domains or paths for which the cookies are not scoped.\n\nyt-dlp version 2023.07.06 and nightly 2023.07.06.185519 fix this issue by removing the `Cookie` header upon HTTP redirects; having native downloaders calculate the `Cookie` header from the cookiejar, utilizing external downloaders' built-in support for cookies instead of passing them as header arguments, disabling HTTP redirectiong if the external downloader does not have proper cookie support, processing cookies passed as HTTP headers to limit their scope, and having a separate field for cookies in the info dict storing more information about scoping\n\nSome workarounds are available for those who are unable to upgrade. Avoid using cookies and user authentication methods. While extractors may set custom cookies, these usually do not contain sensitive information. Alternatively, avoid using `--load-info-json`. Or, if authentication is a must: verify the integrity of download links from unknown sources in browser (including redirects) before passing them to yt-dlp; use `curl` as external downloader, since it is not impacted; and/or avoid fragmented formats such as HLS/m3u8, DASH/mpd and ISM.",
					"title": "Vulnerability description"
				}
			],
			"product_status": {
				"fixed": [
					"openSUSE Tumbleweed:yt-dlp-2023.07.06-1.1",
					"openSUSE Tumbleweed:yt-dlp-bash-completion-2023.07.06-1.1",
					"openSUSE Tumbleweed:yt-dlp-fish-completion-2023.07.06-1.1",
					"openSUSE Tumbleweed:yt-dlp-zsh-completion-2023.07.06-1.1"
				]
			},
			"references": [
				{
					"category": "external",
					"summary": "CVE-2023-35934",
					"url": "https://www.suse.com/security/cve/CVE-2023-35934"
				},
				{
					"category": "external",
					"summary": "SUSE Security Ratings",
					"url": "https://www.suse.com/support/security/rating/"
				},
				{
					"category": "external",
					"summary": "SUSE Bug 1213124 for CVE-2023-35934",
					"url": "https://bugzilla.suse.com/1213124"
				}
			],
			"remediations": [
				{
					"category": "vendor_fix",
					"details": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
					"product_ids": [
						"openSUSE Tumbleweed:yt-dlp-2023.07.06-1.1",
						"openSUSE Tumbleweed:yt-dlp-bash-completion-2023.07.06-1.1",
						"openSUSE Tumbleweed:yt-dlp-fish-completion-2023.07.06-1.1",
						"openSUSE Tumbleweed:yt-dlp-zsh-completion-2023.07.06-1.1"
					]
				}
			],
			"scores": [
				{
					"cvss_v3": {
						"baseScore": 6.1,
						"baseSeverity": "MEDIUM",
						"vectorString": "CVSS:3.1/AV:N/AC:H/PR:N/UI:R/S:C/C:H/I:N/A:N",
						"version": "3.1"
					},
					"products": [
						"openSUSE Tumbleweed:yt-dlp-2023.07.06-1.1",
						"openSUSE Tumbleweed:yt-dlp-bash-completion-2023.07.06-1.1",
						"openSUSE Tumbleweed:yt-dlp-fish-completion-2023.07.06-1.1",
						"openSUSE Tumbleweed:yt-dlp-zsh-completion-2023.07.06-1.1"
					]
				}
			],
			"threats": [
				{
					"category": "impact",
					"date": "2023-07-06T22:01:29Z",
					"details": "moderate"
				}
			],
			"title": "CVE-2023-35934"
		}
	]
}
