{
  "document": {
    "aggregate_severity": {
      "namespace": "https://www.suse.com/support/security/rating/",
      "text": "moderate"
    },
    "category": "csaf_vex",
    "csaf_version": "2.0",
    "distribution": {
      "text": "Copyright 2023 SUSE LLC. All rights reserved.",
      "tlp": {
        "label": "WHITE",
        "url": "https://www.first.org/tlp/"
      }
    },
    "lang": "en",
    "notes": [
      {
        "category": "summary",
        "text": "SUSE CVE-2020-11013",
        "title": "Title"
      },
      {
        "category": "description",
        "text": "Their is an information disclosure vulnerability in Helm from version 3.1.0 and before version 3.2.0. `lookup` is a Helm template function introduced in Helm v3. It is able to lookup resources in the cluster to check for the existence of specific resources and get details about them. This can be used as part of the process to render templates. The documented behavior of `helm template` states that it does not attach to a remote cluster. However, a the recently added `lookup` template function circumvents this restriction and connects to the cluster even during `helm template` and `helm install|update|delete|rollback --dry-run`. The user is not notified of this behavior. Running `helm template` should not make calls to a cluster. This is different from `install`, which is presumed to have access to a cluster in order to load resources into Kubernetes. Helm 2 is unaffected by this vulnerability. A malicious chart author could inject a `lookup` into a chart that, when rendered through `helm template`, performs unannounced lookups against the cluster a user&#39;s `KUBECONFIG` file points to. This information can then be disclosed via the output of `helm template`. This issue has been fixed in Helm 3.2.0",
        "title": "Description of the CVE"
      },
      {
        "category": "legal_disclaimer",
        "text": "CSAF 2.0 data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
        "title": "Terms of use"
      }
    ],
    "publisher": {
      "category": "vendor",
      "contact_details": "https://www.suse.com/support/security/contact/",
      "name": "SUSE Product Security Team",
      "namespace": "https://www.suse.com/"
    },
    "references": [
      {
        "category": "external",
        "summary": "CVE-2020-11013",
        "url": "https://www.suse.com/security/cve/CVE-2020-11013"
      },
      {
        "category": "external",
        "summary": "SUSE Security Ratings",
        "url": "https://www.suse.com/support/security/rating/"
      },
      {
        "category": "external",
        "summary": "SUSE Bug 1173121 for CVE-2020-11013",
        "url": "https://bugzilla.suse.com/1173121"
      }
    ],
    "title": "SUSE CVE CVE-2020-11013",
    "tracking": {
      "current_release_date": "2023-02-15T04:00:04Z",
      "generator": {
        "date": "2023-02-15T04:00:04Z",
        "engine": {
          "name": "cve-database.git:bin/generate-csaf-vex.pl",
          "version": "1"
        }
      },
      "id": "CVE-2020-11013",
      "initial_release_date": "2023-02-15T04:00:04Z",
      "revision_history": [
        {
          "date": "2023-02-15T04:00:04Z",
          "number": "2",
          "summary": "Current version"
        }
      ],
      "status": "interim",
      "version": "2"
    }
  },
  "product_tree": {
    "branches": [
      {
        "branches": [
          {
            "branches": [
              {
                "category": "product_name",
                "name": "SUSE CaaS Platform 4.0",
                "product": {
                  "name": "SUSE CaaS Platform 4.0",
                  "product_id": "SUSE CaaS Platform 4.0",
                  "product_identification_helper": {
                    "cpe": "cpe:/o:suse:caasp:4.0"
                  }
                }
              },
              {
                "category": "product_version",
                "name": "helm",
                "product": {
                  "name": "helm",
                  "product_id": "helm",
                  "product_identification_helper": {
                    "cpe": "cpe:2.3:a:helm:helm:*:*:*:*:*:*:*:*"
                  }
                }
              }
            ],
            "category": "product_family",
            "name": "SUSE Linux Enterprise"
          }
        ],
        "category": "vendor",
        "name": "SUSE"
      }
    ],
    "relationships": [
      {
        "category": "default_component_of",
        "full_product_name": {
          "name": "helm as component of SUSE CaaS Platform 4.0",
          "product_id": "SUSE CaaS Platform 4.0:helm"
        },
        "product_reference": "helm",
        "relates_to_product_reference": "SUSE CaaS Platform 4.0"
      }
    ]
  },
  "vulnerabilities": [
    {
      "cve": "CVE-2020-11013",
      "ids": [
        {
          "system_name": "SUSE CVE Page",
          "text": "https://www.suse.com/security/cve/CVE-2020-11013"
        }
      ],
      "notes": [
        {
          "category": "general",
          "text": "Their is an information disclosure vulnerability in Helm from version 3.1.0 and before version 3.2.0. `lookup` is a Helm template function introduced in Helm v3. It is able to lookup resources in the cluster to check for the existence of specific resources and get details about them. This can be used as part of the process to render templates. The documented behavior of `helm template` states that it does not attach to a remote cluster. However, a the recently added `lookup` template function circumvents this restriction and connects to the cluster even during `helm template` and `helm install|update|delete|rollback --dry-run`. The user is not notified of this behavior. Running `helm template` should not make calls to a cluster. This is different from `install`, which is presumed to have access to a cluster in order to load resources into Kubernetes. Helm 2 is unaffected by this vulnerability. A malicious chart author could inject a `lookup` into a chart that, when rendered through `helm template`, performs unannounced lookups against the cluster a user&#39;s `KUBECONFIG` file points to. This information can then be disclosed via the output of `helm template`. This issue has been fixed in Helm 3.2.0",
          "title": "Vulnerability description"
        }
      ],
      "product_status": {
        "known not affected": [
          "SUSE CaaS Platform 4.0:helm"
        ]
      },
      "references": [
        {
          "category": "external",
          "summary": "CVE-2020-11013",
          "url": "https://www.suse.com/security/cve/CVE-2020-11013"
        },
        {
          "category": "external",
          "summary": "SUSE Security Ratings",
          "url": "https://www.suse.com/support/security/rating/"
        },
        {
          "category": "external",
          "summary": "SUSE Bug 1173121 for CVE-2020-11013",
          "url": "https://bugzilla.suse.com/1173121"
        }
      ],
      "threats": [
        {
          "category": "impact",
          "date": "2020-04-25T02:47:53Z",
          "details": "moderate"
        }
      ],
      "title": "CVE-2020-11013"
    }
  ]
}
