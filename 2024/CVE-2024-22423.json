{
	"document": {
		"aggregate_severity": {
			"namespace": "https://www.suse.com/support/security/rating/",
			"text": "low"
		},
		"category": "csaf_vex",
		"csaf_version": "2.0",
		"distribution": {
			"text": "Copyright 2024 SUSE LLC. All rights reserved.",
			"tlp": {
				"label": "WHITE",
				"url": "https://www.first.org/tlp/"
			}
		},
		"lang": "en",
		"notes": [
			{
				"category": "summary",
				"text": "SUSE CVE-2024-22423",
				"title": "Title"
			},
			{
				"category": "description",
				"text": "yt-dlp is a youtube-dl fork with additional features and fixes. The patch that addressed CVE-2023-40581 attempted to prevent RCE when using `--exec` with `%q` by replacing double quotes with two double quotes. However, this escaping is not sufficient, and still allows expansion of environment variables. Support for output template expansion in `--exec`, along with this vulnerable behavior, was added to `yt-dlp` in version 2021.04.11. yt-dlp version 2024.04.09 fixes this issue by properly escaping `%`. It replaces them with `%%cd:~,%`, a variable that expands to nothing, leaving only the leading percent. It is recommended to upgrade yt-dlp to version 2024.04.09 as soon as possible. Also, always be careful when using `--exec`, because while this specific vulnerability has been patched, using unvalidated input in shell commands is inherently dangerous. For Windows users who are not able to upgrade, avoid using any output template expansion in `--exec` other than `{}` (filepath); if expansion in `--exec` is needed, verify the fields you are using do not contain `\"`, `|` or `&`; and/or instead of using `--exec`, write the info json and load the fields from it instead.",
				"title": "Description of the CVE"
			},
			{
				"category": "legal_disclaimer",
				"text": "CSAF 2.0 data is provided by SUSE under the Creative Commons License 4.0 with Attribution (CC-BY-4.0).",
				"title": "Terms of use"
			}
		],
		"publisher": {
			"category": "vendor",
			"contact_details": "https://www.suse.com/support/security/contact/",
			"name": "SUSE Product Security Team",
			"namespace": "https://www.suse.com/"
		},
		"references": [
			{
				"category": "external",
				"summary": "CVE-2024-22423",
				"url": "https://www.suse.com/security/cve/CVE-2024-22423"
			},
			{
				"category": "external",
				"summary": "SUSE Security Ratings",
				"url": "https://www.suse.com/support/security/rating/"
			},
			{
				"category": "external",
				"summary": "SUSE Bug 1226223 for CVE-2024-22423",
				"url": "https://bugzilla.suse.com/1226223"
			}
		],
		"title": "SUSE CVE CVE-2024-22423",
		"tracking": {
			"current_release_date": "2024-06-13T03:59:44Z",
			"generator": {
				"date": "2024-04-11T02:31:39Z",
				"engine": {
					"name": "cve-database.git:bin/generate-csaf-vex.pl",
					"version": "1"
				}
			},
			"id": "CVE-2024-22423",
			"initial_release_date": "2024-04-11T02:31:39Z",
			"revision_history": [
				{
					"date": "2024-04-11T02:31:39Z",
					"number": "2",
					"summary": "Current version"
				},
				{
					"date": "2024-06-13T03:59:44Z",
					"number": "3",
					"summary": "Current version"
				}
			],
			"status": "interim",
			"version": "3"
		}
	},
	"product_tree": {
		"branches": [
			{
				"branches": [
					{
						"branches": [
							{
								"category": "product_name",
								"name": "openSUSE Tumbleweed",
								"product": {
									"name": "openSUSE Tumbleweed",
									"product_id": "openSUSE Tumbleweed",
									"product_identification_helper": {
										"cpe": "cpe:/o:opensuse:tumbleweed"
									}
								}
							},
							{
								"category": "product_version",
								"name": "python310-yt-dlp-2024.04.09-1.1",
								"product": {
									"name": "python310-yt-dlp-2024.04.09-1.1",
									"product_id": "python310-yt-dlp-2024.04.09-1.1"
								}
							},
							{
								"category": "product_version",
								"name": "python311-yt-dlp-2024.04.09-1.1",
								"product": {
									"name": "python311-yt-dlp-2024.04.09-1.1",
									"product_id": "python311-yt-dlp-2024.04.09-1.1"
								}
							},
							{
								"category": "product_version",
								"name": "python312-yt-dlp-2024.04.09-1.1",
								"product": {
									"name": "python312-yt-dlp-2024.04.09-1.1",
									"product_id": "python312-yt-dlp-2024.04.09-1.1"
								}
							},
							{
								"category": "product_version",
								"name": "yt-dlp-2024.04.09-1.1",
								"product": {
									"name": "yt-dlp-2024.04.09-1.1",
									"product_id": "yt-dlp-2024.04.09-1.1"
								}
							},
							{
								"category": "product_version",
								"name": "yt-dlp-bash-completion-2024.04.09-1.1",
								"product": {
									"name": "yt-dlp-bash-completion-2024.04.09-1.1",
									"product_id": "yt-dlp-bash-completion-2024.04.09-1.1"
								}
							},
							{
								"category": "product_version",
								"name": "yt-dlp-fish-completion-2024.04.09-1.1",
								"product": {
									"name": "yt-dlp-fish-completion-2024.04.09-1.1",
									"product_id": "yt-dlp-fish-completion-2024.04.09-1.1"
								}
							},
							{
								"category": "product_version",
								"name": "yt-dlp-zsh-completion-2024.04.09-1.1",
								"product": {
									"name": "yt-dlp-zsh-completion-2024.04.09-1.1",
									"product_id": "yt-dlp-zsh-completion-2024.04.09-1.1"
								}
							}
						],
						"category": "product_family",
						"name": "SUSE Linux Enterprise"
					}
				],
				"category": "vendor",
				"name": "SUSE"
			}
		],
		"relationships": [
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "python310-yt-dlp-2024.04.09-1.1 as component of openSUSE Tumbleweed",
					"product_id": "openSUSE Tumbleweed:python310-yt-dlp-2024.04.09-1.1"
				},
				"product_reference": "python310-yt-dlp-2024.04.09-1.1",
				"relates_to_product_reference": "openSUSE Tumbleweed"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "python311-yt-dlp-2024.04.09-1.1 as component of openSUSE Tumbleweed",
					"product_id": "openSUSE Tumbleweed:python311-yt-dlp-2024.04.09-1.1"
				},
				"product_reference": "python311-yt-dlp-2024.04.09-1.1",
				"relates_to_product_reference": "openSUSE Tumbleweed"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "python312-yt-dlp-2024.04.09-1.1 as component of openSUSE Tumbleweed",
					"product_id": "openSUSE Tumbleweed:python312-yt-dlp-2024.04.09-1.1"
				},
				"product_reference": "python312-yt-dlp-2024.04.09-1.1",
				"relates_to_product_reference": "openSUSE Tumbleweed"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "yt-dlp-2024.04.09-1.1 as component of openSUSE Tumbleweed",
					"product_id": "openSUSE Tumbleweed:yt-dlp-2024.04.09-1.1"
				},
				"product_reference": "yt-dlp-2024.04.09-1.1",
				"relates_to_product_reference": "openSUSE Tumbleweed"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "yt-dlp-bash-completion-2024.04.09-1.1 as component of openSUSE Tumbleweed",
					"product_id": "openSUSE Tumbleweed:yt-dlp-bash-completion-2024.04.09-1.1"
				},
				"product_reference": "yt-dlp-bash-completion-2024.04.09-1.1",
				"relates_to_product_reference": "openSUSE Tumbleweed"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "yt-dlp-fish-completion-2024.04.09-1.1 as component of openSUSE Tumbleweed",
					"product_id": "openSUSE Tumbleweed:yt-dlp-fish-completion-2024.04.09-1.1"
				},
				"product_reference": "yt-dlp-fish-completion-2024.04.09-1.1",
				"relates_to_product_reference": "openSUSE Tumbleweed"
			},
			{
				"category": "default_component_of",
				"full_product_name": {
					"name": "yt-dlp-zsh-completion-2024.04.09-1.1 as component of openSUSE Tumbleweed",
					"product_id": "openSUSE Tumbleweed:yt-dlp-zsh-completion-2024.04.09-1.1"
				},
				"product_reference": "yt-dlp-zsh-completion-2024.04.09-1.1",
				"relates_to_product_reference": "openSUSE Tumbleweed"
			}
		]
	},
	"vulnerabilities": [
		{
			"cve": "CVE-2024-22423",
			"ids": [
				{
					"system_name": "SUSE CVE Page",
					"text": "https://www.suse.com/security/cve/CVE-2024-22423"
				}
			],
			"notes": [
				{
					"category": "general",
					"text": "yt-dlp is a youtube-dl fork with additional features and fixes. The patch that addressed CVE-2023-40581 attempted to prevent RCE when using `--exec` with `%q` by replacing double quotes with two double quotes. However, this escaping is not sufficient, and still allows expansion of environment variables. Support for output template expansion in `--exec`, along with this vulnerable behavior, was added to `yt-dlp` in version 2021.04.11. yt-dlp version 2024.04.09 fixes this issue by properly escaping `%`. It replaces them with `%%cd:~,%`, a variable that expands to nothing, leaving only the leading percent. It is recommended to upgrade yt-dlp to version 2024.04.09 as soon as possible. Also, always be careful when using `--exec`, because while this specific vulnerability has been patched, using unvalidated input in shell commands is inherently dangerous. For Windows users who are not able to upgrade, avoid using any output template expansion in `--exec` other than `{}` (filepath); if expansion in `--exec` is needed, verify the fields you are using do not contain `\"`, `|` or `&`; and/or instead of using `--exec`, write the info json and load the fields from it instead.",
					"title": "CVE description"
				}
			],
			"product_status": {
				"recommended": [
					"openSUSE Tumbleweed:python310-yt-dlp-2024.04.09-1.1",
					"openSUSE Tumbleweed:python311-yt-dlp-2024.04.09-1.1",
					"openSUSE Tumbleweed:python312-yt-dlp-2024.04.09-1.1",
					"openSUSE Tumbleweed:yt-dlp-2024.04.09-1.1",
					"openSUSE Tumbleweed:yt-dlp-bash-completion-2024.04.09-1.1",
					"openSUSE Tumbleweed:yt-dlp-fish-completion-2024.04.09-1.1",
					"openSUSE Tumbleweed:yt-dlp-zsh-completion-2024.04.09-1.1"
				]
			},
			"references": [
				{
					"category": "external",
					"summary": "CVE-2024-22423",
					"url": "https://www.suse.com/security/cve/CVE-2024-22423"
				},
				{
					"category": "external",
					"summary": "SUSE Security Ratings",
					"url": "https://www.suse.com/support/security/rating/"
				},
				{
					"category": "external",
					"summary": "SUSE Bug 1226223 for CVE-2024-22423",
					"url": "https://bugzilla.suse.com/1226223"
				}
			],
			"remediations": [
				{
					"category": "vendor_fix",
					"details": "To install this SUSE Security Update use the SUSE recommended installation methods like YaST online_update or \"zypper patch\".\n",
					"product_ids": [
						"openSUSE Tumbleweed:python310-yt-dlp-2024.04.09-1.1",
						"openSUSE Tumbleweed:python311-yt-dlp-2024.04.09-1.1",
						"openSUSE Tumbleweed:python312-yt-dlp-2024.04.09-1.1",
						"openSUSE Tumbleweed:yt-dlp-2024.04.09-1.1",
						"openSUSE Tumbleweed:yt-dlp-bash-completion-2024.04.09-1.1",
						"openSUSE Tumbleweed:yt-dlp-fish-completion-2024.04.09-1.1",
						"openSUSE Tumbleweed:yt-dlp-zsh-completion-2024.04.09-1.1"
					]
				}
			],
			"threats": [
				{
					"category": "impact",
					"date": "2024-04-09T20:00:16Z",
					"details": "low"
				}
			],
			"title": "CVE-2024-22423"
		}
	]
}
